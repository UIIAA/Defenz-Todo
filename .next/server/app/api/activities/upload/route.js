(()=>{var e={};e.id=475,e.ids=[475],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},54943:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>x,routeModule:()=>l,serverHooks:()=>v,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>d,config:()=>c});var o=r(96559),a=r(48088),i=r(37719),n=r(32190),u=r(81437);async function d(e){try{let t=(await e.formData()).get("file");if(!t)return n.NextResponse.json({success:!1,error:"Nenhum arquivo enviado"},{status:400});if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.oasis.opendocument.spreadsheet"].includes(t.type)&&!t.name.match(/\.(xlsx|xls|ods)$/i))return n.NextResponse.json({success:!1,error:"Formato de arquivo inv\xe1lido. Use .xlsx, .xls ou .ods"},{status:400});let r=await t.arrayBuffer(),s=Buffer.from(r),o=u.LF(s,{type:"buffer"}),a=o.SheetNames[0],i=o.Sheets[a],d=u.Wp.sheet_to_json(i);if(!d||0===d.length)return n.NextResponse.json({success:!1,error:"Planilha vazia ou formato inv\xe1lido"},{status:400});let c=d.map((e,t)=>{let r=t=>{for(let r of t)if(void 0!==e[r]&&null!==e[r])return String(e[r]);return""};return{title:r(["T\xedtulo","Title","O Qu\xea?","O Que?","Atividade","Task","titulo"]),description:r(["Descri\xe7\xe3o","Description","Por Qu\xea?","Por Que?","Justificativa","descricao"]),area:r(["\xc1rea","Area","Setor","area"]),priority:(()=>{let e=r(["Prioridade","Priority","prioridade","priority"]);return e.toLowerCase().includes("alta")||e.toLowerCase().includes("high")||"0"===e?0:e.toLowerCase().includes("m\xe9dia")||e.toLowerCase().includes("medium")||"1"===e?1:e.toLowerCase().includes("baixa")||e.toLowerCase().includes("low")||"2"===e?2:1})(),status:(()=>{let e=r(["Status","Estado","status"]);return e.toLowerCase().includes("conclu\xeddo")||e.toLowerCase().includes("completed")||e.toLowerCase().includes("concluido")?"completed":e.toLowerCase().includes("andamento")||e.toLowerCase().includes("progress")?"in_progress":"pending"})(),responsible:r(["Respons\xe1vel","Responsible","Quem?","Quem","responsavel"]),deadline:r(["Prazo","Deadline","Quando?","Quando","Data","prazo"]),location:r(["Local","Location","Onde?","Onde","local"]),how:r(["Como?","Como","How","M\xe9todo","Processo"]),cost:r(["Custo","Cost","Quanto?","Quanto","Valor","Investimento"])}}).filter(e=>e.title&&""!==e.title.trim());if(0===c.length)return n.NextResponse.json({success:!1,error:"Nenhuma atividade v\xe1lida encontrada na planilha"},{status:400});return n.NextResponse.json({success:!0,data:c,count:c.length,message:`${c.length} atividades importadas com sucesso`})}catch(e){return console.error("Upload Excel error:",e),n.NextResponse.json({success:!1,error:"Erro ao processar arquivo Excel",details:e.message},{status:500})}}let c={api:{bodyParser:!1}},l=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/activities/upload/route",pathname:"/api/activities/upload",filename:"route",bundlePath:"app/api/activities/upload/route"},resolvedPagePath:"/Users/marcoscruz/Documents/Projetos/Defenz/Defenz - To-Do/src/app/api/activities/upload/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:p,workUnitAsyncStorage:m,serverHooks:v}=l;function x(){return(0,i.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:m})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[243,580,437],()=>r(54943));module.exports=s})();